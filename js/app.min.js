;(function(){var clockClass=function(a){return this.init(a)};
clockClass.prototype={init:function(a){this.set(a);this.cnv=document.getElementById(this.setting.id);this.c=this.cnv.getContext("2d");this.render(0,0,10);return this},set:function(a){this.setting=$.extend({id:"",colorBack:"#FFF",colorMiddle:"#DDD",colorFront:"#29F",shadow:!1},a);return this},render:function(a,b,c){var d=this.cnv.width/2,f=0.8*Math.round(0.98*d),e=0.8*Math.round(0.6*d);b=2*Math.PI*b/c;this.c.fillStyle=this.setting.colorBack;this.c.fillRect(0,0,2*d,2*d);this.c.translate(d,d);this.c.rotate(-Math.PI/
2);!1!=this.setting.shadow&&(c=this.setting.shadow.split(" "),this.c.shadowOffsetX=parseInt(c[0]),this.c.shadowOffsetY=parseInt(c[1]),this.c.shadowBlur=parseInt(c[2]),this.c.shadowColor=c[3]);this.c.fillStyle=this.setting.colorMiddle;this.c.beginPath();this.c.arc(0,0,f,0,Math.PI/180*360,!1);this.c.fill();this.c.closePath();!1!=this.setting.shadow&&(this.c.shadowOffsetX=0,this.c.shadowOffsetY=0,this.c.shadowBlur=0);this.c.fillStyle=this.setting.colorFront;this.c.beginPath();this.c.moveTo(0,0);this.c.lineTo(d+
f,0);this.c.arc(0,0,f,0,b,!1);this.c.fill();this.c.closePath();this.c.fillStyle=this.setting.colorBack;this.c.beginPath();this.c.arc(0,0,e,0,Math.PI/180*360,!1);this.c.fill();this.c.closePath();this.c.setTransform(1,0,0,1,0,0);this.c.font="bold "+1.1*e+"px sans-serif";f=this.c.measureText(""+a);this.c.fillStyle=this.setting.colorFront;this.c.fillText(""+a,d-f.width/2,1.2*d);return this}};var modalsClass=function(a){return this.init(a)};
modalsClass.prototype={init:function(a){this.app=a;this.$dimmer=$("#dimmer");this.modalConfiguration().modalStopPractice().modalResults().modalPostResults().modalAutosize().modalPreferences().modalHelp().modalWelcome().helpCorners();this.clockPostConfiguration=new clockClass({id:"post-configure-new-practice-clock",colorMiddle:"#EEE"});return this},toggle:function(a,b){b?("modal"!=this.app.scene&&(this.app.prevScene=this.app.scene,this.app.scene="modal"),$("#"+a).add(this.$dimmer).addClass("visible")):
(this.app.scene=this.app.prevScene,$("#"+a).add(this.$dimmer).removeClass("visible"));return this},modalConfiguration:function(){var a=this,b=$("#start-practice");this.dropCountSketch=new dropdownClass({id:"input-num-model",options:"10 sketches;15 sketches;20 sketches;35 sketches;50 sketches;75 sketches;100 sketches".split(";"),values:"10 15 20 35 50 75 100".split(" "),inputId:"input-save-number",current:0});this.dropCountTime=new dropdownClass({id:"input-num-time",options:"10 seconds;15 seconds;30 seconds;1 minute;2 minutes;5 minutes;10 minutes".split(";"),
values:"10 15 30 60 120 300 600".split(" "),inputId:"input-save-duration",current:2});var c=this.app.cat,d=$("#categories"),f=$("#input-save-cat"),e=$('<ul class="main-ul-cat"></ul>').appendTo(d),g=function(){var a=1;e.find(">li.with-child.active").each(function(){a++;$(this).find(">ul>li.with-child.active").each(function(){a++})});$("#categories").width(200*a)},h=function(){var a="";d.find(".main-ul-cat > li.active,li.active > ul > li.active").each(function(){a+=$(this).attr("id")+","});f.val(a.substring(0,
a.length-1))},l=0,s=function(a,b){var c=$('<span rel="">View all</span>'),d=$('<li class="view-all" rel="" id="catId-'+l+'"></li>').appendTo(a).append(c);l++;c.click(function(){$(this).parent().addClass("active").siblings().removeClass("active");g();h()});for(var e=0;e<b.length;e++)d=b[e][0].split("+"),c=$("<span>"+d[0]+"</span>"),d=$('<li rel="'+d[1]+'" id="catId-'+l+'"></li>').appendTo(a).append(c),l++,c.click(function(){$(this).parent().find(">ul>li").removeClass("active").eq(0).addClass("active");
$(this).parent().addClass("active").siblings().removeClass("active");g();h()}),"undefined"!=typeof b[e][1]&&(c=$("<ul></ul>").appendTo(d.addClass("with-child")),s(c,b[e][1]))};s(e,c);(function(){for(var a=f.val().split(","),b=0;b<a.length;b++)$("#"+a[b]).addClass("active")})();g();$("#cancel-practice").click(function(){a.toggle("configure-new-practice-modal",!1);a.app.scene=a.app.prevScene});b.click(function(){if(!$(this).hasClass("disable")){var b="";e.find(">li.active").each(function(){b+=$(this).attr("rel");
$(this).find(">ul>li.active").each(function(){var a=$(this).attr("rel");""!=a&&(b+="/"+a);$(this).find(">ul>li.active").each(function(){var a=$(this).attr("rel");""!=a&&(b+="/"+a)})})});a.app.practice.setNew({tags:"",cat:b,length:a.dropCountSketch.val,duration:a.dropCountTime.val});a.toggle("configure-new-practice-modal",!1).toggle("post-configure-new-practice-modal",!0).startPostModalConfiguration()}});return this},startPostModalConfiguration:function(){$("#post-configure-new-practice-modal").removeClass("error");
var a=this,b=0,c=setInterval(function(){a.clockPostConfiguration.render("",b,20);b++;20<b&&(b=0);a.app.photo.loaded&&(a.toggle("post-configure-new-practice-modal",!1),a.app.scene="practice",a.app.practice.togglePlay(),clearInterval(c),c=null)},50);$("#try-again-load").click(function(){a.toggle("post-configure-new-practice-modal",!1).toggle("configure-new-practice-modal",!0)});return this},modalStopPractice:function(){var a=this;$("#continue-practice").click(function(){a.toggle("stop-modal",!1)});
$("#stop-practice").click(function(){a.toggle("stop-modal",!1);a.app.practice.stop()});return this},toggleImageFinal:function(a){a?$("#result-image-container").fadeIn(300):$("#result-image-container").fadeOut(300);return this},modalResults:function(){var a=this;$("#close-result-container").click(function(){a.toggle("results-modal",!1).toggle("post-results-modal",!0)});$("#close-result-image-container").click(function(){a.toggleImageFinal(!1)});return this},modalPostResults:function(){var a=this;$("#cancel-post-result").click(function(){a.toggle("post-results-modal",
!1)});$("#ok-post-result").click(function(){a.toggle("post-results-modal",!1).toggle("configure-new-practice-modal",!0)});return this},modalAutosize:function(){var a=$(window),b=$(".modal[autosize]"),c=function(){b.each(function(){var b=a.height()-20,c=parseInt($(this).attr("autosize"));b<c?$(this).addClass("fixsize"):$(this).removeClass("fixsize")})};c();a.resize(c);return this},modalPreferences:function(){var a=this,b=$(".checkbox").each(function(){var a=$(this);a.parent("p").addClass("label-checkbox").click(function(){a.toggleClass("true")})});
$("#ok-preferences").click(function(){a.app.ui.toggleLeft($("#ch-use-left").hasClass("true"));a.app.ui.toggleOwn($("#ch-use-own").hasClass("true"));a.toggle("preferences-modal",!1)});this.app.leftHanded&&b.eq(0).toggleClass("true");this.app.ownApp&&b.eq(1).toggleClass("true");return this},modalHelp:function(){var a=this,b=$(".link-help.prev"),c=$(".link-help.next");this.$helpSection=$(".help-section");this.$helpMenuLi=$(".help-menu li");this.$helpMenuLi.each(function(b){$(this).click(function(){a.modalHelpChangeSection(b)})});
b.each(function(b){$(this).click(function(c){c.preventDefault();a.modalHelpChangeSection(b)})});c.each(function(b){$(this).click(function(c){c.preventDefault();a.modalHelpChangeSection(b+1)})});$(".welcome-text").clone().appendTo(".welcome-text-content");$("#ok-help").click(function(){a.toggle("help-modal",!1)});return this},modalHelpChangeSection:function(a){this.$helpMenuLi.removeClass("current").eq(a).addClass("current");this.$helpSection.removeClass("current").eq(a).addClass("current");return this},
modalWelcome:function(a){var b=this;$("#welcome-start").click(function(){b.toggle("welcome-modal",!1).toggle("configure-new-practice-modal",!0)});return this},helpCorners:function(a){var b=this;$(".help-corner").click(function(){var a=parseInt($(this).attr("rel"))||0;b.modalHelpChangeSection(a).toggle("help-modal",!0)});return this}};var colorClass=function(a){return this.init(a)};
colorClass.prototype={init:function(a){this.app=a;this.colEdit=0;this.canvasSV=document.getElementById("color-cnv-gradient-sat-val");this.canvasH=document.getElementById("color-cnv-gradient-hue");this.cSV=this.canvasSV.getContext("2d");this.cH=this.canvasH.getContext("2d");this.cursorSV=document.getElementById("color-sat-val-cursor");this.cursorH=document.getElementById("color-hue-cursor");this.$foreSample=$("#foreground-color-sample");this.$backSample=$("#background-color-sample");this.$toolColor=
$("#tool-color");this.$canvasSection=$("#paint-section");this.valGr=this.cSV.createLinearGradient(0,0,0,140);this.valGr.addColorStop(0,"rgba(0,0,0,0)");this.valGr.addColorStop(1,"rgba(0,0,0,1)");a=this.cH.createLinearGradient(0,0,0,140);a.addColorStop(0,"rgb(255,0,0)");a.addColorStop(1/6,"rgb(255,255,0)");a.addColorStop(1/3,"rgb(0,255,0)");a.addColorStop(0.5,"rgb(0,255,255)");a.addColorStop(2/3,"rgb(0,0,255)");a.addColorStop(5/6,"rgb(255,0,255)");a.addColorStop(1,"rgb(255,0,0)");this.cH.fillStyle=
a;this.cH.fillRect(0,0,20,140);this.setEvents();this.update();return this},setForeOrBackColor:function(a){this.colEdit=a;this.update();return this},setColor:function(a){this.app.paint.colors[this.colEdit].color(a);this.update();return this},update:function(){this.updateInfo().drawSV().updateCursors();return this},updateInfo:function(){this.$foreSample.css("background-color",this.app.paint.colors[0].hex());this.$backSample.add(this.$canvasSection).css("background-color",this.app.paint.colors[1].hex());
this.app.paint.updatePickerCanvas();return this},drawSV:function(){var a=this.app.paint.colors[this.colEdit].hsvToRgb({h:this.app.paint.colors[this.colEdit].h(),s:1,v:1});this.satGr=this.cSV.createLinearGradient(0,0,140,0);this.satGr.addColorStop(0,"rgb(255,255,255)");this.satGr.addColorStop(1,"rgb("+a.r+","+a.g+","+a.b+")");this.cSV.fillStyle=this.satGr;this.cSV.fillRect(0,0,140,140);this.cSV.fillStyle=this.valGr;this.cSV.fillRect(0,0,140,140);return this},updateCursors:function(){this.cursorH.style.top=
Math.round(140*this.app.paint.colors[this.colEdit].h())+"px";this.cursorSV.style.top=140-Math.round(140*this.app.paint.colors[this.colEdit].v())+"px";this.cursorSV.style.left=Math.round(140*this.app.paint.colors[this.colEdit].s())+"px";return this},setHueFromMouse:function(a){a=a.pageY-this.canvasH.getBoundingClientRect().top;0>a&&(a=0);140<a&&(a=140);this.cursorH.style.top=a+"px";this.app.paint.colors[this.colEdit].h(a/140);this.update()},setSVFromMouse:function(a){var b=a.pageX-this.canvasSV.getBoundingClientRect().left;
a=a.pageY-this.canvasSV.getBoundingClientRect().top;0>b&&(b=0);140<b&&(b=140);0>a&&(a=0);140<a&&(a=140);this.cursorSV.style.left=b+"px";this.cursorSV.style.top=a+"px";this.app.paint.colors[this.colEdit].s(b/140).v(1-a/140);this.update()},setEvents:function(){var a=this,b=!1,c=!1;this.canvasH.addEventListener("mousedown",function(b){c=!0;a.setHueFromMouse(b)},!1);this.cursorH.addEventListener("mousedown",function(b){c=!0;a.setHueFromMouse(b)},!1);this.canvasSV.addEventListener("mousedown",function(c){b=
!0;a.setSVFromMouse(c)},!1);this.cursorSV.addEventListener("mousedown",function(c){b=!0;a.setSVFromMouse(c)},!1);document.body.addEventListener("mousemove",function(d){c&&a.setHueFromMouse(d);b&&a.setSVFromMouse(d)},!1);document.body.addEventListener("mouseup",function(){c&&(c=!1);b&&(b=!1)},!1);var d=!1,f=!1,e=function(){f&&!d&&(a.$toolColor.removeClass("open"),f=!1);d=!1};this.$foreSample.click(function(){a.setForeOrBackColor(0);a.$toolColor.addClass("open").removeClass("for-background");d=f=!0});
this.$backSample.click(function(){a.setForeOrBackColor(1);a.$toolColor.addClass("open").addClass("for-background");d=f=!0});$("#color-ctrl").click(function(){d=!0});$("body").click(e);$("#draw-canvas").mousedown(e);return this}};var toolsClass=function(a){return this.init(a)};
toolsClass.prototype={init:function(a){this.app=a;this.player().setEventBrush();return this},setEventBrush:function(){var a=this;$(".tool.brush").each(function(b){$(this).click(function(){a.app.paint.setPreset(b)})});$(".tool.picker").click(function(){a.app.paint.setPicker()});return this},player:function(){this.$title=$("#title-player-canvas");this.prevTitleText=this.titleText="";this.$cnv=$("#player-canvas");this.c=this.$cnv[0].getContext("2d");this.width=this.$cnv.width();this.height=this.$cnv.height();
this.hitAreaWidth=this.width/3;this.hover=0;this.color="#FFF";this.hoverColor="#29F";this.c.shadowBlur=3;this.c.shadowColor="rgba(0,0,0,.5)";this.c.shadowOffsetY=1;this.renderPlayer().setEventPlayer();return this},renderPlayer:function(){this.c.clearRect(0,0,this.width,this.height);this.c.fillStyle=1==this.hover?this.hoverColor:this.color;this.app.practice.playing?(this.c.beginPath(),this.c.moveTo(11,11),this.c.lineTo(16,11),this.c.lineTo(16,23),this.c.lineTo(11,23),this.c.lineTo(11,11),this.c.fill(),
this.c.closePath(),this.c.beginPath(),this.c.moveTo(18,11),this.c.lineTo(23,11),this.c.lineTo(23,23),this.c.lineTo(18,23),this.c.lineTo(18,11)):(this.c.beginPath(),this.c.moveTo(11,11),this.c.lineTo(23,17),this.c.lineTo(11,23),this.c.lineTo(11,11));this.c.fill();this.c.closePath();this.c.fillStyle=2==this.hover?this.hoverColor:this.color;this.c.beginPath();this.c.moveTo(43,11);this.c.lineTo(51,17);this.c.lineTo(43,23);this.c.lineTo(43,11);this.c.fill();this.c.closePath();this.c.beginPath();this.c.moveTo(51,
11);this.c.lineTo(59,17);this.c.lineTo(51,23);this.c.lineTo(51,11);this.c.fill();this.c.closePath();this.c.fillStyle=3==this.hover?this.hoverColor:this.color;this.c.beginPath();this.c.moveTo(79,11);this.c.lineTo(91,11);this.c.lineTo(91,23);this.c.lineTo(79,23);this.c.lineTo(79,11);this.c.fill();this.c.closePath();this.titleText!=this.prevTitleText&&(this.$title.text(this.titleText),this.prevTitleText=this.titleText);return this},setEventPlayer:function(){var a=this,b=function(b){b=b.pageX-a.$cnv.offset().left;
b<a.hitAreaWidth?(a.hover=1,a.titleText=a.app.practice.playing?"Pause (SPACEBAR)":"Play (SPACEBAR)"):b>2*a.hitAreaWidth?(a.hover=3,a.titleText="Stop"):(a.hover=2,a.titleText="Next model (RIGHT ARROW)");a.renderPlayer()};this.$cnv.mousemove(function(a){b(a)}).mouseout(function(){a.hover=0;a.renderPlayer()}).click(function(c){b(c);switch(a.hover){case 1:a.app.practice.enabled&&a.app.practice.togglePlay();break;case 2:a.app.practice.enabled&&a.app.practice.forceNext();break;case 3:a.app.practice.enabled&&
a.app.ui.modals.toggle("stop-modal",!0)}});return this}};var keyboardClass=function(a){return this.init(a)};
keyboardClass.prototype={init:function(a){this.app=a;this.setKey();return this},setKey:function(){var a=this,b=!1;document.addEventListener("keydown",function(c){if(!b)switch(b=!0,c=c.keyCode?c.keyCode:c.charCode,a.app.scene){case "practice":switch(c){case 18:a.app.paint.setPicker()}}},!1);document.addEventListener("keyup",function(c){b=!1;c=c.keyCode?c.keyCode:c.charCode;switch(a.app.scene){case "practice":switch(c){case 80:a.app.paint.setPreset(0);break;case 69:a.app.paint.setPreset(1);break;case 79:a.app.paint.setPreset(2);
break;case 87:a.app.paint.setPreset(3);break;case 65:a.app.paint.setPreset(4);break;case 66:a.app.paint.setPreset(5);break;case 73:a.app.paint.setPicker();break;case 18:a.app.paint.setPreset(a.app.paint.presetPreviousPicker);break;case 32:a.app.practice.togglePlay();break;case 39:a.app.practice.forceNext()}}},!1);return this}};var dropdownClass=function(a){return this.init(a)};
dropdownClass.prototype={init:function(a){this.setting=$.extend({id:"",options:["1 opt","2 opt","3 opt","4 opt"],values:["1","2","3","4"],inputId:"",current:0,callback:function(){}},a);this.open=!1;this.current=-1;this.val=0;this.$dropdown=$("#"+this.setting.id);this.render().setEvents();this.$input=null;""!=this.setting.inputId&&(this.$input=$("#"+this.setting.inputId),this.updateByInput());return this},render:function(){if(0<this.$dropdown.length){this.$dropdown.html("");this.$result=$('<span class="dropdown-result"></span>').appendTo(this.$dropdown);
this.$list=$('<span class="dropdown-list"></span>').appendTo(this.$dropdown);for(var a=0;a<this.setting.options.length;a++)$('<span class="dropdown-list-option" rel="'+a+'">'+this.setting.options[a]+"</span>").appendTo(this.$list);this.$options=this.$list.find(".dropdown-list-option");this.setCurrent(this.setting.current)}return this},setEvents:function(){if(0<this.$dropdown.length){var a=this,b=!1;this.$dropdown.click(function(){a.open||(a.$dropdown.addClass("open"),a.$list.fadeIn(150),b=a.open=
!0)});$("body").click(function(){a.open&&!b&&(a.$dropdown.removeClass("open"),a.$list.fadeOut(150),a.open=!1);b=!1});this.$options.click(function(){var b=parseInt($(this).attr("rel"));b!=a.current&&(a.setCurrent(b),a.setting.callback())})}return this},updateByInput:function(){for(var a=0;a<this.setting.values.length;a++)this.setting.values[a]==this.$input.val()&&a!=this.current&&this.setCurrent(a);return this},setCurrent:function(a){this.current=a;this.$options.removeClass("current").eq(a).addClass("current");
this.$result.html(this.setting.options[a]);this.val=parseInt(this.setting.values[a]);null!=this.$input&&this.$input.val(this.val);this.$dropdown.attr("val",this.val);return this}};var menuClass=function(a){return this.init(a)};
menuClass.prototype={init:function(a){this.app=a;this.open=!1;this.$menu=$("#main-menu");this.setEventMenu().setEventBtn();return this},setEventMenu:function(){var a=this,b=!1;$("#main-menu-trigger").click(function(){a.open||(a.$menu.addClass("open"),b=a.open=!0)});$("body").click(function(){a.open&&!b&&(a.$menu.removeClass("open"),a.open=!1);b=!1});return this},setEventBtn:function(){var a=this;$("#menu-new").click(function(){a.app.ui.modals.toggle("configure-new-practice-modal",!0)});$("#menu-preferences").click(function(){a.app.ui.modals.toggle("preferences-modal",
!0)});$("#menu-help").click(function(){a.app.ui.modals.toggle("help-modal",!0).modalHelpChangeSection(0)});$("#menu-about").click(function(){a.app.ui.modals.toggle("help-modal",!0).modalHelpChangeSection(7)});return this}};var uiClass=function(a){return this.init(a)};
uiClass.prototype={init:function(a){this.app=a;this.$inputLeftHanded=$("#input-save-left-handed");this.$inputOwnApp=$("#input-save-own-app");"true"==this.$inputLeftHanded.val()&&this.toggleLeft(!0);"true"==this.$inputOwnApp.val()&&this.toggleOwn(!0);this.color=new colorClass(this.app);this.modals=new modalsClass(this.app);this.tools=new toolsClass(this.app);this.keyboard=new keyboardClass(this.app);this.menu=new menuClass(this.app);var b=this;setTimeout(function(){$("#presentation").fadeOut(400,function(){b.modals.toggle("welcome-modal",
!0)})},2E3);return this},toggleLeft:function(a){a?$("#application").addClass("left-handed"):$("#application").removeClass("left-handed");this.$inputLeftHanded.val(a);this.app.leftHanded=a;return this},toggleOwn:function(a){a?($("#application").addClass("own-app"),$("#main-menu").appendTo("#photo-section .tools")):($("#application").removeClass("own-app"),$("#main-menu").appendTo("#paint-section"));this.$inputOwnApp.val(a);this.app.ownApp=a;return this}};var photoClass=function(a){return this.init(a)};
photoClass.prototype={data:null,length:0,current:0,currentContainer:0,loaded:!1,tags:"",init:function(a){this.app=a;this.$containers=$(".photo-container");this.$images=$(".photo-image");this.$imageInfos=$(".photo-info");return this},getPhotos:function(a,b){this.loaded=!1;this.tags=a;this.cat=b;this.$containers.removeClass("visible");var c=this;setTimeout(function(){c.$images.attr("src","")},500);this.numAjaxCall=0;this.ajaxCall();return this},ajaxCall:function(){var a=this,b="http://backend.deviantart.com/rss.xml?type=deviation&q=boost%3Apopular";
""!=this.cat&&(b+="+in%3A"+encodeURIComponent(this.cat));""!=this.tags&&(b+="+"+this.tags);$.ajax({url:"http://query.yahooapis.com/v1/public/yql",jsonp:"callback",dataType:"jsonp",data:{q:'select * from rss where url ="'+b+'"',format:"json"},success:function(b){a.successData(b)},error:function(b){a.errorData(b)}});return this},successData:function(a){null!=a.query.results?(this.data=a.query.results.item,this.length=a.query.results.item.length,this.setCurrentNum(),this.currentContainer=0,this.loaded=
!0,this.loadImage()):this.errorData();return this},setCurrentNum:function(){var a=Math.round(Math.random()*this.length)-1;0>a&&(a=0);a==this.current&&(a--,0>a&&(a=0));this.current=a;return this},errorData:function(a){this.numAjaxCall++;3>this.numAjaxCall?this.ajaxCall():$("#post-configure-new-practice-modal").addClass("error");return this},loadImage:function(){for(var a,b=0;1E3>b;b++)"undefined"!=typeof this.data[this.current].content?"undefined"!=typeof this.data[this.current].content.url?(a=this.data[this.current].content.url,
b=1E3):this.current++:this.current++,this.current>=this.length&&(this.current=0);this.$images.eq(this.currentContainer).attr("src",a);this.putUserInfo(this.current);this.setCurrentNum();return this},putUserInfo:function(a){a=this.data[a].copyright.content+'. <a href="'+this.data[a].copyright.url+'" target="_blank" title="Go to profile in DeviantART">Link</a>.';this.$imageInfos.eq(this.currentContainer).html(a);return this},show:function(){this.$containers.removeClass("visible").eq(this.currentContainer).addClass("visible");
this.currentContainer++;1<this.currentContainer&&(this.currentContainer=0);var a=this;setTimeout(function(){a.loadImage()},600);return this}};var hypercolor=function(a){return this.init(a)};
hypercolor.prototype={init:function(a){this.values={r:0,g:0,b:0,h:0,s:0,v:0,hex:"#000000"};this.color(a);return this},color:function(a){return void 0!=a?("string"==typeof a?(-1<a.indexOf("#")&&this.hex(a),-1<a.indexOf("rgb")&&this.rgb(a),-1<a.indexOf("hsv")&&this.hsv(a)):(void 0!=a.r&&this.rgb(a),void 0!=a.h&&this.hsv(a)),this):this.values},merge:function(a){this.values=$.extend(this.values,a);return this},hex:function(a){return void 0!=a&&"string"==typeof a?(this.merge({hex:a}).merge(this.hexToRgb(a)).merge(this.hexToHsv(a)),
this):this.values.hex},rgb:function(a){return void 0!=a?("string"==typeof a&&(a=a.substring(4,a.length-1).split(","),a={r:parseInt(a[0]),g:parseInt(a[1]),b:parseInt(a[2])}),this.merge({hex:this.rgbToHex(a)}).merge(this.rgbToHsv(a)).merge(a),this):{r:this.values.r,g:this.values.g,b:this.values.b}},hsv:function(a){return void 0!=a?("string"==typeof a&&(a=a.substring(4,a.length-1).split(","),a={h:parseFloat(a[0]),s:parseFloat(a[1]),v:parseFloat(a[2])}),this.merge({hex:this.hsvToHex(a)}).merge(this.hsvToRgb(a)).merge(a),
this):{h:this.values.h,s:this.values.s,v:this.values.v}},r:function(a){return void 0!=a?(this.rgb({r:a,g:this.values.g,b:this.values.b}),this):this.values.r},g:function(a){return void 0!=a?(this.rgb({r:this.values.r,g:a,b:this.values.b}),this):this.values.g},b:function(a){return void 0!=a?(this.rgb({r:this.values.r,g:this.values.g,b:a}),this):this.values.b},h:function(a){return void 0!=a?(this.hsv({h:a,s:this.values.s,v:this.values.v}),this):this.values.h},s:function(a){return void 0!=a?(this.hsv({h:this.values.h,
s:a,v:this.values.v}),this):this.values.s},v:function(a){return void 0!=a?(this.hsv({h:this.values.h,s:this.values.s,v:a}),this):this.values.v},rgbString:function(){return"rgb("+this.values.r+","+this.values.g+","+this.values.b+")"},rgbaHalfString:function(){return"rgba("+this.values.r+","+this.values.g+","+this.values.b+","},hexToRgb:function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,c,d,f){return c+c+d+d+f+f});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],
16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},hexToHsv:function(a){return this.rgbToHsv(this.hexToRgb(a))},rgbToHex:function(a){var b=function(a){a=a.toString(16);return 1==a.length?"0"+a:a},c=a.g,d=a.b;return"#"+b(a.r)+b(c)+b(d)},hsvToHex:function(a){return this.rgbToHex(this.hsvToRgb(a))},rgbToHsv:function(a){var b=a.r,c=a.g;a=a.b;b/=255;c/=255;a/=255;var d=Math.max(b,c,a),f=Math.min(b,c,a),e,g=d-f;if(d==f)e=0;else{switch(d){case b:e=(c-a)/g+(c<a?6:0);break;case c:e=(a-b)/g+2;break;case a:e=
(b-c)/g+4}e/=6}return{h:e,s:0==d?0:g/d,v:d}},hsvToRgb:function(a){var b=parseFloat(a.h),c=parseFloat(a.s);a=parseFloat(a.v);var d,f,e,g=Math.floor(6*b),h=6*b-g,b=a*(1-c),l=a*(1-h*c),c=a*(1-(1-h)*c);switch(g%6){case 0:d=a;f=c;e=b;break;case 1:d=l;f=a;e=b;break;case 2:d=b;f=a;e=c;break;case 3:d=b;f=l;e=a;break;case 4:d=c;f=b;e=a;break;case 5:d=a,f=b,e=l}return{r:Math.round(255*d),g:Math.round(255*f),b:Math.round(255*e)}}};
var brushPresets=function(){return[{radius:3,spacing:0.13,opacity:0.7,hardness:0.86,rotation:0,roundness:0.51,blending:0,dirtcolor:!1,randomOpacity:0.39,randomHardness:0.5,randomRotation:1,randomRoundness:0,randomRadius:0.12,randomScattering:0,velocityRadius:[-1,0.2],velocityOpacity:[-1,0.5]},{radius:20,spacing:0.19,opacity:0.75,hardness:0.8,rotation:0,roundness:1,blending:0,dirtcolor:!1,randomOpacity:0,randomHardness:0,randomRotation:0,randomRoundness:0,randomRadius:0,randomScattering:0,velocityRadius:!1,
velocityOpacity:!1},{radius:15,spacing:0.15,opacity:1,hardness:0.8,rotation:0,roundness:1,blending:0.62,dirtcolor:!0,randomOpacity:0,randomHardness:0,randomRotation:0,randomRoundness:0,randomRadius:0,randomScattering:0,velocityRadius:[1,2],velocityOpacity:!1},{radius:10,spacing:0.08,opacity:0.2,hardness:0.71,rotation:0,roundness:1,blending:0.6,dirtcolor:!1,randomOpacity:0.11,randomHardness:0,randomRotation:0,randomRoundness:0,randomRadius:0.02,randomScattering:0,velocityRadius:[1,9],velocityOpacity:!1},
{radius:100,spacing:0.21,opacity:0.42,hardness:0.2,rotation:0,roundness:1,blending:0,dirtcolor:!1,randomOpacity:0,randomHardness:0,randomRotation:0,randomRoundness:0,randomRadius:0,randomScattering:0,velocityRadius:!1,velocityOpacity:!1},{radius:7,spacing:0.15,opacity:0.14,hardness:0.62,rotation:0,roundness:1,blending:1,dirtcolor:!1,randomOpacity:0,randomHardness:0,randomRotation:0,randomRoundness:0,randomRadius:0,randomScattering:0.02,velocityRadius:[1,10],velocityOpacity:!1}]},pickerClass=function(a){return this.init(a)};
pickerClass.prototype={rgb:{r:0,g:0,b:0},imageData:null,w:0,init:function(a){this.paint=a;this.$sample=$("#picker-sample");return this},pick:function(a,b){var c=4*(a+b*this.paint.width);this.rgb="rgb("+this.paint.currentImageData.data[c]+","+this.paint.currentImageData.data[c+1]+","+this.paint.currentImageData.data[c+2]+")";this.$sample.css({top:b+"px",left:a+"px","background-color":this.rgb,display:"block"});return this},setColor:function(){this.paint.app.ui.color.setForeOrBackColor(0).setColor(this.rgb);
this.$sample.css({display:"none"});return this}};var brushClass=function(a){return this.init(a)};
brushClass.prototype={init:function(a){this.paint=a;this.setting={radius:20,spacing:0.15,opacity:1,hardness:1,rotation:0,roundness:1,blending:0,dirtcolor:!1,randomOpacity:0,randomHardness:0,randomRotation:0,randomRoundness:0,randomRadius:0,randomScattering:0,velocityRadius:!1,velocityOpacity:!1};return this},set:function(a){this.setting=$.extend(this.setting,a);return this},update:function(){this.spacingPx=2*this.setting.spacing*this.setting.radius;this.velOpacity=this.velRadius=0;this.paint.c.globalCompositeOperation=
this.paint.eraserMode?"destination-out":"source-over";return this},draw:function(a,b,c){c=this.m(a,b,c);this.paint.c.translate(a+c.rsX,b+c.rsY);this.paint.c.rotate(c.rotation*Math.PI/180);this.paint.c.scale(1,c.roundness);this.paint.c.fillStyle=c.radgrad;this.paint.c.fillRect(-c.radius,-c.radius,2*c.radius,2*c.radius);this.paint.c.setTransform(1,0,0,1,0,0);return this},dirtColor:function(){this.setting.dirtcolor&&this.paint.app.ui.color.setForeOrBackColor(0).setColor(this.dirtFore);return this},m:function(a,
b,c){var d=this.setting.opacity,f=this.setting.rotation,e=this.setting.roundness,g=this.setting.hardness,h=this.setting.radius,l=0,s=0,k=this.setting.blending,p=1,m="rgba("+this.paint.colors[0].r()+","+this.paint.colors[0].g()+","+this.paint.colors[0].b()+",";this.dirtFore="rgb("+this.paint.colors[0].r()+","+this.paint.colors[0].g()+","+this.paint.colors[0].b()+")";0<this.setting.randomOpacity&&(d+=this.setting.randomOpacity*(2*Math.random()-1));0<this.setting.randomRotation&&(f+=180*this.setting.randomRotation*
(2*Math.random()-1));0<this.setting.randomRoundness&&(e+=this.setting.randomRoundness*(2*Math.random()-1),0.01>e&&(e=0.01),1<e&&(e=1));0<this.setting.randomHardness&&(g+=this.setting.randomHardness*(2*Math.random()-1),0.1>g&&(g=0.1),0.99<g&&(g=0.99));0<this.setting.randomRadius&&(h+=this.setting.radius*this.setting.randomRadius*(2*Math.random()-1));0<this.setting.randomScattering&&(l=h*this.setting.randomScattering*50*(2*Math.random()-1),s=h*this.setting.randomScattering*50*(2*Math.random()-1));!1!=
this.setting.velocityRadius&&(this.velRadius+=0.05*(this.setting.velocityRadius[1]*c-this.velRadius),h=Math.round(h*(1+this.setting.velocityRadius[0]*this.velRadius/100)),1>h&&(h=1),this.spacingPx=2*this.setting.spacing*h);!1!=this.setting.velocityOpacity&&(this.velOpacity+=0.01*(this.setting.velocityOpacity[1]*c-this.velOpacity),d*=1+this.setting.velocityOpacity[0]*this.velOpacity/100,0>d&&(d=0),1<d&&(d=1));if(0<k){m=this.paint.colors[0].r();c=this.paint.colors[0].g();for(var r=this.paint.colors[0].b(),
n=this.paint.currentBlendingImageData.data.length,q=Math.round(0.7*h),u=a-q,v=b-q,w=0,x=b=0,y=0,z=0,A=0,B=0,t=0,C=0;9>C;C++){t=4*(u+v*this.paint.width);if(0<t&&t<n){var D=this.paint.currentBlendingImageData.data[t+3],B=B+D;x++;0<D&&(y+=this.paint.currentBlendingImageData.data[t],z+=this.paint.currentBlendingImageData.data[t+1],A+=this.paint.currentBlendingImageData.data[t+2],b++)}w++;u+=q;3<=w&&(u=a-q,v+=q,w=0)}a=m;n=c;q=r;0<b&&(a=Math.round(m-k*(m-y/b)),n=Math.round(c-k*(c-z/b)),q=Math.round(r-k*
(r-A/b)));0<x&&(p=Math.round(100*(d-k*(d-B/x/255)))/100);m="rgba("+a+","+n+","+q+",";this.dirtFore="rgb("+a+","+n+","+q+")"}k=this.paint.c.createRadialGradient(0,0,0,0,0,h);k.addColorStop(0,m+g*p*d+")");k.addColorStop(g,m+g*p*d+")");k.addColorStop(1,m+"0)");return{opacity:d,rotation:f,roundness:e,hardness:g,radius:h,rsX:l,rsY:s,radgrad:k}}};var paintClass=function(a){return this.init(a)};
paintClass.prototype={init:function(a){this.app=a;this.onPaint=!1;this.tool="brush";this.eraserMode=!1;this.enabled=!0;this.currentBlendingImageData=this.currentImageData=null;this.$inputForecolor=$("#input-save-forecolor");this.$inputBackcolor=$("#input-save-backcolor");a=this.$inputForecolor.val();var b=this.$inputBackcolor.val();this.colors=[new hypercolor(a),new hypercolor(b)];this.$paintSection=$("#paint-section");this.$canvas=this.$paintSection.find("canvas.to-draw");this.resizeCanvas();this.cnv=
this.$canvas[0];this.cnvBlending=this.$canvas[1];this.cnvPicker=this.$canvas[2];this.c=this.cnv.getContext("2d");this.cBlending=this.cnvBlending.getContext("2d");this.cPicker=this.cnvPicker.getContext("2d");this.$inputTool=$("#input-save-tool");this.picker=new pickerClass(this);this.brush=new brushClass(this);this.brushPresets=brushPresets();this.presetPreviousPicker=parseInt(this.$inputTool.val());this.updatePickerCanvas().setPreset(this.presetPreviousPicker).setEvents();return this},resizeCanvas:function(){this.width=
this.$paintSection.width();this.height=this.$paintSection.height();this.$canvas.attr({width:this.width,height:this.height});return this},saveColors:function(){this.$inputForecolor.val(this.colors[0].hex());this.$inputBackcolor.val(this.colors[1].hex());return this},setPreset:function(a){this.presetPreviousPicker=a;this.tool="brush";this.eraserMode=1==a?!0:!1;$(".tool").removeClass("current").eq(a).addClass("current");this.brush.set(this.brushPresets[a]);this.$inputTool.val(a);return this},setPicker:function(){this.tool=
"picker";$(".tool.brush").removeClass("current");$(".tool.picker").addClass("current");return this},updatePickerCanvas:function(){this.cPicker.fillStyle=this.colors[1].hex();this.cPicker.fillRect(0,0,this.width,this.height);this.cPicker.drawImage(this.cnv,0,0,this.width,this.height);this.currentImageData=this.cPicker.getImageData(0,0,this.width,this.height);this.cBlending.clearRect(0,0,this.width,this.height);this.cBlending.drawImage(this.cnv,0,0,this.width,this.height);this.currentBlendingImageData=
this.cBlending.getImageData(0,0,this.width,this.height);return this},setEvents:function(){var a=this,b=!1,c=null,d=null,f=0,e=null,g=!1,h=!1,l=this.width-90,s=function(b){return{x:b.pageX-a.$paintSection.offset().left,y:b.pageY-a.$paintSection.offset().top}};this.$canvas.eq(0).mousedown(function(c){if(a.enabled&&a.app.practice.enabled)switch(e=s(c),l=this.width-90,b=!0,a.tool){case "brush":a.brush.update().draw(e.x,e.y,0);a.app.practice.wasPainted=!0;a.saveColors();break;case "picker":a.picker.pick(e.x,
e.y)}});this.$paintSection.mousemove(function(k){if(b&&a.enabled&&a.app.practice.enabled)switch(e=s(k),!g&&90>e.x&&(a.$paintSection.addClass("hide-tool"),g=!0),g&&90<=e.x&&(a.$paintSection.removeClass("hide-tool"),g=!1),!h&&e.x>l&&(a.$paintSection.addClass("hide-menu"),h=!0),h&&e.x<=l&&(a.$paintSection.removeClass("hide-menu"),h=!1),a.tool){case "brush":null==c&&(c=e.x);null==d&&(d=e.y);var p=e.x-c,m=e.y-d;k=Math.sqrt(p*p+m*m);f+=k;if(f>=a.brush.spacingPx){var r=Math.round(k/a.brush.spacingPx);0!=
r&&(p/=r,m/=r);for(var n=0;n<=r;n++)a.brush.draw(Math.round(c+p*n),Math.round(d+m*n),k);f=0}c=e.x;d=e.y;break;case "picker":a.picker.pick(e.x,e.y)}});$("body").mouseup(function(){if(b)switch(h=g=!1,d=c=null,a.tool){case "brush":a.brush.dirtColor();a.$paintSection.removeClass("hide-tool").removeClass("hide-menu");a.updatePickerCanvas();break;case "picker":a.picker.setColor()}b=!1});return this}};var practiceClass=function(a){return this.init(a)};
practiceClass.prototype={current:0,playing:!1,miliseconds:0,milisecondsTotal:0,seconds:0,enabled:!1,started:!1,resultList:[],wasPainted:!1,init:function(a){this.app=a;this.setting={tags:"",length:5,duration:5};this.$results=$("#result-list");this.$resultImage=$("#result-image");this.clock=new clockClass({id:"clock-canvas",colorBack:"#CCC",colorMiddle:"#AAA",colorFront:"#FFF",shadow:"0 1px 2px rgba(0,0,0,.5)"});var b=this;setInterval(function(){b.playing&&b.enabled&&"practice"==b.app.scene&&(b.miliseconds++,
b.milisecondsTotal++,20==b.miliseconds&&(b.miliseconds=0,b.seconds++,b.seconds==b.setting.duration&&(b.seconds=0,b.milisecondsTotal=0,b.next())),b.clock.render(b.current,b.milisecondsTotal,20*b.setting.duration))},50);return this},resetTimer:function(){this.seconds=this.milisecondsTotal=this.miliseconds=0;return this},setNew:function(a){this.setting=$.extend({tags:"",cat:"",length:5,duration:5},a);this.current=0;this.resultList=[];this.enabled=!0;this.started=this.playing=!1;this.resetTimer();this.app.photo.getPhotos(this.setting.tags,
this.setting.cat);return this},togglePlay:function(a){"undefined"!=typeof a&&(this.playing=!a);this.playing?this.playing=!1:(this.started||(this.app.paint.resizeCanvas(),this.next()),this.playing=!0);this.app.ui.tools.renderPlayer();return this},stop:function(){this.togglePlay(!1);this.enabled=!1;this.app.ui.tools.renderPlayer();this.saveResult().renderResults()},next:function(){this.current++;this.current>this.setting.length?(this.stop(),this.current--):(this.app.photo.show(),this.app.ui.tools.renderPlayer(),
this.started&&this.saveResult(),this.started=!0);return this},forceNext:function(){this.milisecondsTotal=this.miliseconds=this.seconds=0;this.playing=!0;this.next();return this},saveResult:function(){var a=this,b=$("#next-sketch");this.app.paint.enabled=!1;this.app.paint.updatePickerCanvas();this.wasPainted&&this.resultList.push(this.app.paint.currentImageData);this.wasPainted=!1;this.app.paint.resizeCanvas();this.app.paint.$canvas.eq(0).fadeOut(250,function(){a.app.paint.c.clearRect(0,0,a.app.paint.width,
a.app.paint.height);a.app.paint.updatePickerCanvas();$(this).show();a.app.paint.enabled=!0});b.fadeIn(250,function(){setTimeout(function(){b.fadeOut(200)},1E3)});return this},renderResults:function(){if(this.app.ownApp)this.app.ui.modals.toggle("post-results-modal",!0);else{var a=this.resultList.length,b=100,c=1,d=500,f=500,e=this;this.$results.html("");if(0<a)for(var g=0;g<a;g++)d=this.resultList[g].width,f=this.resultList[g].height,c=258/d,b=Math.round(c*f),this.app.paint.$canvas.eq(2).attr({width:d,
height:f}),this.app.paint.cPicker.putImageData(this.resultList[g],0,0),b=$('<canvas width="258" height="'+b+'" rel="'+g+'"></canvas>'),this.$results.append(b),d=b[0].getContext("2d"),d.scale(c,c),d.drawImage(this.app.paint.cnvPicker,0,0),b.click(function(){e.renderImageFinal(parseInt($(this).attr("rel")))});else this.$results.append($('<div class="no-sketches">No sketches</div>'));this.app.ui.modals.toggle("results-modal",!0)}return this},renderImageFinal:function(a){this.app.paint.cPicker.putImageData(this.resultList[a],
0,0);this.$resultImage.attr("src",this.app.paint.cnvPicker.toDataURL("image/png"));this.app.ui.modals.toggleImageFinal(!0);return this}};var appClass=function(){return this.init()};
appClass.prototype={tags:"animal man woman architecture art car motorcycle anatomy nature tree flowers culture naked music objects design sports illustration fashion costume technology kid products tatoo landscape people travel horse dragon ship manga comic face hands foot eye mountain sea",cat:[["Photography+photography",[["Animals, Plants & Nature+nature",[["Wild Animals+wild"],["Domesticated Animals+domestic"],["Aquatic Life+underwater"],["Birds+birds"],["Reptiles & Amphibians+reptiles"],["Invertebrates+insects"],
["Flowers, Trees & Plants+flora"],["Landscapes+landscapes"],["Waterscapes+waterscapes"],["Weather and Sky+sky"]]],["Architecture+architecture",[["Bridges & Structures+bridges"],["Statues & Monuments+statues"],["Exterior+exterior"],["Interior+interior"]]],["Macro+macro",[["Human+human"],["Nature+nature"],["Objects+objects"]]],["People & Portraits+people",[["Body Art+bodyart"],["Classic Portraits+portraits"],["Self-Portraits+selfportrait"],["Spontaneous Portraits+spontaneous"],["Emotive Portraits+emotive"],
["Expressive+expressive"],["Fashion Portraits+fashion"],["Glamour Portraits+glamour"],["Children+children"],["Pin-up+pinup"]]],["Photojournalism+journalism",[["Military+military"],["People+people"],["Performing Arts+performing"],["Political+political"],["Sports+sports"]]],["Still Life+still",[["Plant Arrangement+arrangements"],["Dolls and Figures+figures"],["Food and Drink+food"]]],["Transportation+transportation"],["Urban & Rural+civilization",[["Cityscapes & Skylines+cityscape"],["Country Life+country"],
["Gardens & Parks+gardens"],["Industrial+industrial"]]]]],["Manga & Anime+manga",[["Digital Media+digital",[["3D+3d"],["Drawings+drawings"],["Manga (comics)+manga"],["Paintings+paintings"]]],["Traditional Media+traditional",[["Drawings+drawings"],["Manga (comics)+manga"],["Paintings+paintings"]]]]],["Images+resources/stockart",[["3D & Renders+3drenders"],["Animals+animals",[["Mammals+mammals"]]],["Plants+plants"],["Human+model",[["Children+children"],["Female+women"],["Male+men"],["Groups+people"]]],
["Nature+nature",[["Landscapes+landscapes"],["Waterscapes+waterscapes"],["Skies+skies"]]],["Objects+objects"],["Places+places"]]]],leftHanded:!1,ownApp:!1,init:function(){return this},start:function(){this.scene=this.prevScene="presentation";this.photo=new photoClass(this);this.paint=new paintClass(this);this.practice=new practiceClass(this);this.ui=new uiClass(this);return this}};var app=new appClass;$("document").ready(function(){app.start()});})();